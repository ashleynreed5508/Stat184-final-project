---
title: "Stat 184 Final Project"
author: "Ashley Reed"
subtitle: "Chicago Crime: 2001 to Present"
output: html_notebook
---

In this project, I will be analyzing data collected by the Chicago Police Department that was posted for public access on the Chicago Data Portal. This data set contained 6.75 million cases providing information on 22 different variables. Each case represents a reported crime. 

The variables include:

* ID (Unique ID numbers for each reported crime)
* Case number (Unique combinations of numbers and letters used by the Chicago Police Department to identify cases)
* Date
* Block
* IUCR (Illinois Uniform Crime Reporting code)
* Primary Type (general description of IUCR code)
* Description (detailed description of IUCR code)
* Location Description
* Arrest (true or false)
* Domestic (true of false)
* Beat
* District
* Ward
* Community Area
* FBI Code
* X-coordinate (location)
* Y-coordinate (location)
* Year
* Updated On (date of last update)
* Latitude
* Longitude 
* Location


### Front Matter

```{r}
rm(list = ls())

library(rvest)
library(tidyverse)
library(tidyr)
library(mosaic)
library(lubridate)
library(DataComputing)
library(readr)
library(lubridate)
library(knitr)

```

### Reading in the Data

I downloaded the data set from the Chicago Data Portal as a CSV file and used read_csv() from the readr package to create a data set named ChicagoCrime that I can work with in R

```{r, results = "hide"}

ChicagoCrimeOriginal <-
read_csv("Crimes_-_2001_to_present.csv")

``` 

```{r}

ChicagoCrimeOriginal

```

### Cleaning the Data

In order to clean up the data to make it tidy and ready for analysis, I renamed the variables to fit standard data conventions in R programming, selected the variables that will be meaningful for data analysis, changed variable formats to fit what they contain (ex. dates, logical values, etc.), and removed the X or XX included in addresses under the block variable.

```{r}

ChicagoCrime <-
ChicagoCrimeOriginal %>%
  rename(id = ID, casenumber = `Case Number`, date = Date, block = Block, iucr = IUCR, primarytype = `Primary Type`, description = Description, locationdescription = `Location Description`, arrest = Arrest, domestic = Domestic, beat = Beat, district = District, ward = Ward, communityarea = `Community Area`, fbicode = `FBI Code`, xcoordinate = `X Coordinate`, ycoordinate = `Y Coordinate`, year = Year, updated = `Updated On`, lat = Latitude, long = Longitude, location = Location) %>%
  select(date, block, iucr, primarytype, description, locationdescription, arrest, domestic, beat, district, ward, communityarea, fbicode, year, lat, long, location) %>%
  mutate(date = lubridate::mdy_hms(date), arrest = as.logical(arrest), domestic = as.logical(domestic), beat = as.numeric(beat), district = as.numeric(district)) 

ChicagoCrime <-
ChicagoCrime %>% 
  mutate(block = gsub("X|XX","", block))

ChicagoCrime 

```

Now that I have cleaned up the data, I will use data wrangling to analyze the data and come to some meaningful conclusions. I'm curious to find out more about certain districts in Chicago and their relative danger in terms of crimes committed. First, I will manipulate the data to figure out which 5 districts have had the largest number of assaults with and without arrests.

In order to do this, I will select the variables `district`, `arrest`, and `primarytype`, and group by all three of them to make each combination of the variables a unique case. Then, I will summarise the data to find the number of incidences for each case.  To isolate assaults with arrest, I will filter out all `primarytype` results that are not assault, and filter out all `arrest` results that are not TRUE. I will do the opposite for arrest to find the assaults without arrest. Then, I will arrange each new data frame by descending count to find the highest values and restrict them to the top 5 results.

```{r}

ChicagoCrimeAssault <-
ChicagoCrime %>%
  select(district, arrest, primarytype) %>%
  group_by(district, primarytype, arrest) %>%
  summarise(count = n()) %>%
  filter(primarytype == "ASSAULT")

ChicagoCrimeAssault %>%
  filter(arrest == "FALSE") %>%
  arrange(desc(count)) %>%
  head(5)

ChicagoCrimeAssault %>%
  filter(arrest == "TRUE") %>%
  arrange(desc(count)) %>%
  head(5)

ChicagoCrimeAssault %>%
  ggplot(aes(x = district, y = count)) +
  geom_col(aes(fill = arrest), position = "dodge") +
  scale_x_continuous(breaks = c(1:25), limits = c(1,25)) + 
  jpeg("chicagocrimeassault.jpeg", width = 800, height = 300) 

```

The five districts with the highest number of assaults resulting in arrest are, from highest to lowest, districts 7, 8, 4, 6, and 3. The five districts with the highest number of assaults without arrest are, from highest to lowest, districts 7, 4, 6, 8, and 11.

As we can see, 4 of the districts (4, 6, 7, and 8) in the two results remain the same, with some of them switching order. This could indicate that districts 4, 6, 7, and 8 are some of the most dangerous districts in Chicago, though this data does not prove that claim. 






