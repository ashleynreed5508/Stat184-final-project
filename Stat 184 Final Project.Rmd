---
title: "Stat 184 Final Project"
author: "Ashley Reed"
subtitle: "Chicago Crime: 2001 to Present"
output: html_notebook
---

In this project, I will be analyzing data collected by the Chicago Police Department that was posted for public access on the Chicago Data Portal. This data set contained 6.75 million cases providing information on 22 different variables. Each case represents a reported crime. 

The variables include:

* ID (Unique ID numbers for each reported crime)
* Case number (Unique combinations of numbers and letters used by the Chicago Police Department to identify cases)
* Date
* Block
* IUCR (Illinois Uniform Crime Reporting code)
* Primary Type (general description of IUCR code)
* Description (detailed description of IUCR code)
* Location Description
* Arrest (true or false)
* Domestic (true of false)
* Beat
* District
* Ward
* Community Area
* FBI Code
* X-coordinate (location)
* Y-coordinate (location)
* Year
* Updated On (date of last update)
* Latitude
* Longitude 
* Location


### Front Matter

```{r}
rm(list = ls())

library(rvest)
library(tidyverse)
library(tidyr)
library(mosaic)
library(lubridate)
library(DataComputing)
library(readr)
library(lubridate)
library(knitr)

```

### Reading in the Data

```{r, results = "hide"}

ChicagoCrimeOriginal <-
read_csv("Crimes_-_2001_to_present.csv")

# Reading in data from the Chicago Data Portal to create a new data frame in R --------------------------------------------

``` 

```{r}

ChicagoCrimeOriginal

```

### Cleaning the Data

In order to clean up the data to make it tidy and ready for analysis, I renamed the variables to fit standard data conventions in R programming, selected the variables that will be meaningful for data analysis, changed variable formats to fit what they contain (ex. dates, logical values, etc.), and removed the X or XX included in addresses under the block variable.

```{r}

ChicagoCrime <-
ChicagoCrimeOriginal %>%
  rename(id = ID, 
         case_number = `Case Number`, 
         date = Date, 
         block = Block, 
         iucr = IUCR, 
         primary_type = `Primary Type`,
         description = Description,
         location_description = `Location Description`,
         arrest = Arrest,
         domestic = Domestic,
         beat = Beat,
         district = District,
         ward = Ward,
         community_area = `Community Area`,
         fbi_code = `FBI Code`,
         x_coordinate = `X Coordinate`,
         y_coordinate = `Y Coordinate`,
         year = Year,
         updated = `Updated On`,
         lat = Latitude,
         long = Longitude,
         location = Location) %>%
  mutate(date = lubridate::mdy_hms(date),
         arrest = as.logical(arrest),
         domestic = as.logical(domestic),
         beat = as.integer(beat),
         district = as.integer(district),
         block = gsub("X|XX","", block))

# Cleaning Chicago Crime data to fit standard conventions and simplify further work  -------------------------------------

ChicagoCrime 

```

Now that I have cleaned up the data, I will use data wrangling to analyze the data and come to some meaningful conclusions. I'm curious to find out more about crime rates (specifically in terms of arrests) over the years, so I will create a plot of years vs. number of crimes, and plot crimes resulting in arrest and crimes not resulting in arrest seperately.

```{r}

ChicagoCrimeYears <-
  ChicagoCrime %>%
  group_by(year, arrest) %>%
  summarise(count = n()) 

ChicagoCrimeYears %>%
  ggplot(aes(x = year, y = count, color = arrest)) +
  geom_point() +
  geom_line() 

```

```{r}
 
ChicagoCrimeAssault <-
ChicagoCrime %>%
  select(district, arrest, primary_type) %>%
  group_by(district, primary_type, arrest) %>%
  summarise(count = n()) %>%
  filter(primary_type == "ASSAULT") 

ChicagoCrimeAssault %>%
  filter(arrest == "TRUE") %>%
  arrange(desc(count)) %>%
  head(5)

ChicagoCrimeAssault %>%
  filter(arrest == "FALSE") %>%
  arrange(desc(count)) %>%
  head(5)

ChicagoCrimeAssault %>%
  ggplot(aes(x = district, y = count)) +
  geom_col(aes(fill = arrest), position = "dodge") +
  scale_x_continuous(breaks = c(1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25), limits = c(1,25)) 

```

The five districts with the highest number of assaults resulting in arrest are, from highest to lowest, districts 7, 8, 4, 6, and 3. The five districts with the highest number of assaults without arrest are, from highest to lowest, districts 7, 4, 6, 8, and 11.
 
As we can see, 4 of the districts (4, 6, 7, and 8) in the two results remain the same, with some of them switching order. This could indicate that districts 4, 6, 7, and 8 are some of the most dangerous districts in Chicago, though this data does not prove that claim. 
